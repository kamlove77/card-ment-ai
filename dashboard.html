<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì—…ë¬´ ë°ì´í„° ëŒ€ì‹œë³´ë“œ</title>
    <style>
        :root { --primary: #2c3e50; --accent: #3498db; --bg: #f8f9fa; }
        body { font-family: 'Malgun Gothic', sans-serif; margin: 0 auto; padding: 15px; background: var(--bg); max-width: 1100px; color: #333; }
        
        /* í—¤ë” ì˜ì—­ */
        .header { background: var(--primary); color: white; padding: 20px; border-radius: 12px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; }
        .header h1 { margin: 0; font-size: 20px; }
        .back-btn { background: transparent; border: 1px solid white; color: white; padding: 6px 15px; border-radius: 6px; cursor: pointer; text-decoration: none; font-size: 13px; }

        /* ëŒ€ì‹œë³´ë“œ ì¹´ë“œ êµ¬ì„± */
        .grid-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; }
        .card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); border: 1px solid #eee; }
        .card-title { font-weight: bold; font-size: 16px; color: var(--primary); margin-bottom: 15px; border-bottom: 2px solid var(--bg); padding-bottom: 10px; display: flex; justify-content: space-between; }

        /* ë°ì´í„° í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        table { width: 100%; border-collapse: collapse; font-size: 13px; }
        th, td { padding: 12px 8px; border-bottom: 1px solid #f1f1f1; text-align: left; }
        th { color: #777; font-weight: bold; background: #fafafa; }
        tr:hover { background: #f9f9ff; }

        .status-badge { padding: 3px 8px; border-radius: 20px; font-size: 11px; font-weight: bold; }
        .type-a { background: #e3f2fd; color: #1976d2; } /* ì™„ë£Œ/ì •ìƒ ì˜ˆì‹œ */
    </style>
</head>
<body>

<div class="header">
    <h1>ğŸ“Š ë°ì´í„° ê´€ë¦¬ ëŒ€ì‹œë³´ë“œ</h1>
    <a href="index.html" class="back-btn">â¬… ë©”ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
</div>

<div class="grid-container">
    <div class="card" style="grid-column: span 2;">
        <div class="card-title">ğŸ“‹ ìƒì„¸ ì •ë³´ ëª©ë¡ <span style="font-size:12px; color:#999;">Sheet2 ë°ì´í„°</span></div>
        <table id="data-list">
            <thead>
                <tr>
                    <th>ì¹´í…Œê³ ë¦¬</th>
                    <th>ìƒì„¸ ë‚´ìš©</th>
                    <th>ë¹„ê³ </th>
                    <th>ìƒíƒœ</th>
                </tr>
            </thead>
            <tbody id="data-body">
                <tr><td colspan="4" style="text-align:center; padding:50px;">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</td></tr>
            </tbody>
        </table>
    </div>

    <div class="card">
        <div class="card-title">ğŸ’¡ ì£¼ìš” ì°¸ê³ ì‚¬í•­</div>
        <div id="summary-content" style="font-size:14px; line-height:1.8; color:#555;">
            ë°ì´í„° ë¡œë”© í›„ ì—¬ê¸°ì— ìš”ì•½ ì •ë³´ê°€ í‘œì‹œë©ë‹ˆë‹¤.
        </div>
    </div>
</div>

<script>
    const url = "https://script.google.com/macros/s/AKfycbxTpgRKDGBMrq4IAEozIVSR1gtMdlFwOPosubxZUXG4BaYTYFVgk68lZPjF9dqOzRfEbA/exec";

    async function fetchDashboardData() {
        try {
            // í˜„ì¬ GAS ì£¼ì†Œì—ì„œ Sheet2 ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ë„ë¡ ì„¤ê³„ë˜ì—ˆë‹¤ê³  ê°€ì •
            const res = await fetch(url + "?sheet=Sheet2&t=" + Date.now());
            const data = await res.json();
            renderData(data.sheet2Data); // GASì—ì„œ ë³´ë‚´ì£¼ëŠ” ë°ì´í„° êµ¬ì¡°ì— ë§ì¶° ìˆ˜ì • í•„ìš”
        } catch (e) {
            document.getElementById('data-body').innerHTML = '<tr><td colspan="4" style="text-align:center; color:red;">ë°ì´í„° ë¡œë”© ì‹¤íŒ¨</td></tr>';
        }
    }

    function renderData(items) {
        if(!items || items.length === 0) return;
        const body = document.getElementById('data-body');
        body.innerHTML = items.map(item => `
            <tr>
                <td><strong>${item[0] || ''}</strong></td>
                <td>${item[1] || ''}</td>
                <td>${item[2] || ''}</td>
                <td><span class="status-badge type-a">${item[3] || 'í™•ì¸'}</span></td>
            </tr>
        `).join('');
    }

    window.onload = fetchDashboardData;
</script>
</body>
</html>
