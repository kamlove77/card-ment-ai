<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Smart Card Guide</title>
    <style>
        /* ì˜ˆìœ ë””ìì¸ì„ ìœ„í•œ ì»¤ìŠ¤í…€ ì„¤ì • */
        :root {
            --primary-color: #6c5ce7;
            --bg-color: #f0f2f5;
            --card-bg: #ffffff;
            --text-color: #2d3436;
        }

        body { 
            font-family: 'Pretendard', 'Malgun Gothic', sans-serif; 
            margin: 0; padding: 12px; 
            background: var(--bg-color); 
            color: var(--text-color);
        }

        /* ê³µì§€ì‚¬í•­ ì• ë‹ˆë©”ì´ì…˜ ìŠ¤íƒ€ì¼ */
        #notice-banner {
            background: linear-gradient(135deg, #6c5ce7, #a29bfe);
            color: white;
            padding: 10px 15px;
            border-radius: 12px;
            font-size: 13px;
            margin-bottom: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .main-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        /* ì¹´ë“œ í˜•íƒœì˜ ì„¹ì…˜ ë””ìì¸ */
        .glass-card {
            background: var(--card-bg);
            padding: 15px;
            border-radius: 16px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
        }

        .section-title {
            font-size: 14px;
            font-weight: 800;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            color: var(--primary-color);
        }

        select, input {
            width: 100%;
            padding: 12px;
            border: 2px solid #eee;
            border-radius: 10px;
            font-size: 14px;
            transition: 0.3s;
            outline: none;
        }

        select:focus, input:focus { border-color: var(--primary-color); }

        /* ê²°ê³¼ ì°½ ë””ìì¸ */
        .content-box {
            margin-top: 10px;
            padding: 10px;
            background: #f9f9fb;
            border-radius: 8px;
            min-height: 120px;
            font-size: 14px;
            line-height: 1.6;
        }

        .search-item {
            color: #e84393;
            font-weight: bold;
            padding: 5px 0;
            border-bottom: 1px dashed #ddd;
        }

        /* ì‹¤ì  í…Œì´ë¸” ë””ìì¸ */
        .perf-table {
            width: 100%;
            margin-top: 10px;
            border-collapse: separate;
            border-spacing: 0;
            font-size: 12px;
        }

        .perf-table th { background: #f1f2f6; padding: 8px; border-radius: 5px 5px 0 0; }
        .perf-table td { padding: 8px; text-align: center; border-bottom: 1px solid #eee; }
        .today-row { background: #fff9db; font-weight: bold; }
    </style>
</head>
<body>

<div id="notice-banner">ğŸ“¢ <span id="notice-text">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</span></div>

<div class="main-container">
    <div class="glass-card">
        <div class="section-title">ğŸ’¬ ë©˜íŠ¸ ê°€ì´ë“œ</div>
        <select id="ment-select" onchange="showMent()">
            <option value="">ìœ í˜•ì„ ì„ íƒí•˜ì„¸ìš”</option>
        </select>
        <div id="ment-display" class="content-box"></div>
    </div>

    <div class="glass-card">
        <div class="section-title">ğŸ” ë¹ ë¥¸ ê²€ìƒ‰</div>
        <input type="text" id="keyword" oninput="doSearch()" placeholder="ë²ˆí˜¸ ë˜ëŠ” í‚¤ì›Œë“œ ì…ë ¥">
        <div id="search-results" class="content-box" style="min-height: 80px;"></div>

        <div class="section-title" style="margin-top: 20px;">ğŸ“Š ì‹¤ì  í˜„í™©</div>
        <table class="perf-table" id="perf-table"></table>
    </div>
</div>

<script>
    let db = { notice: [], ment: [], perf: [] };
    const url = "https://script.google.com/macros/s/AKfycbxTpgRKDGBMrq4IAEozIVSR1gtMdlFwOPosubxZUXG4BaYTYFVgk68lZPjF9dqOzRfEbA/exec";

    async function fetchData() {
        try {
            const res = await fetch(url + "?t=" + Date.now());
            db = await res.json();
            setupApp();
        } catch (e) { document.getElementById('notice-text').innerText = "ë¡œë“œ ì‹¤íŒ¨"; }
    }

    function setupApp() {
        if(db.notice.length) document.getElementById('notice-text').innerText = db.notice[0].content;
        
        const sel = document.getElementById('ment-select');
        const types = [...new Set(db.ment.map(m => m.type))].filter(Boolean);
        types.forEach(t => { sel.innerHTML += `<option value="${t}">${t}</option>`; });

        if(db.perf.length) {
            let html = '<tr><th>ë‚ ì§œ</th><th>ì‹¤ì </th><th>%</th></tr>';
            html += db.perf.map((p, idx) => `
                <tr class="${idx === db.perf.length - 1 ? 'today-row' : ''}">
                    <td>${p.date}</td><td>${p.val}</td><td>${p.rate || '-'}</td>
                </tr>`).join('');
            document.getElementById('perf-table').innerHTML = html;
        }
    }

    function showMent() {
        const val = document.getElementById('ment-
