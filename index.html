<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì¹´ë“œ ìƒë‹´ í†µí•© ê°€ì´ë“œ</title>
    <style>
        :root { --blue: #007bff; --red: #ff4d4f; --bg: #f2f4f7; --yellow: #fff9c4; }
        body { font-family: 'Malgun Gothic', sans-serif; background: var(--bg); margin: 0; padding: 8px; color: #333; }
        .wrapper { max-width: 1200px; margin: 0 auto; }

        /* âœ… ê³µì§€ì‚¬í•­: ë†’ì´ë¥¼ ë” ì¤„ì—¬ì„œ ê³µê°„ í™•ë³´ */
        .notice-container { 
            background: var(--yellow); border: 1.5px solid #fbc02d; 
            margin-bottom: 10px; border-radius: 10px; 
            height: 110px; display: flex; flex-direction: column;
            padding: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .notice-header { font-weight: bold; font-size: 1rem; margin-bottom: 5px; border-bottom: 1px solid #e6e0a8; padding-bottom: 3px; }
        .notice-list { overflow-y: auto; flex-grow: 1; -webkit-overflow-scrolling: touch; }
        .notice-list::-webkit-scrollbar { width: 4px; display: block !important; }
        .notice-list::-webkit-scrollbar-thumb { background: #fbc02d; border-radius: 10px; }
        .notice-item { border-bottom: 1px dotted #d1cca4; padding: 4px 0; font-size: 0.85rem; display: flex; }
        .notice-date { color: #777; min-width: 70px; font-weight: bold; }

        /* âœ… ë ˆì´ì•„ì›ƒ: PCì—ì„  2ë‹¨, ëª¨ë°”ì¼ì—ì„  ì½¤íŒ©íŠ¸í•˜ê²Œ */
        .main-layout { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .panel { background: white; border-radius: 12px; padding: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.03); height: 520px; display: flex; flex-direction: column; border: 1px solid #e1e4e8; }
        h2 { font-size: 1rem; color: #222; border-bottom: 2px solid var(--blue); padding-bottom: 5px; margin: 0 0 10px 0; }

        .select-box { width: 100%; padding: 10px; border: 1.5px solid #ddd; border-radius: 8px; font-size: 0.95rem; }
        .ment-box { background: #f8fbff; border: 2px solid var(--blue); padding: 15px; border-radius: 10px; flex-grow: 1; font-size: 1rem; line-height: 1.6; white-space: pre-wrap; margin-top: 10px; display: none; overflow-y: auto; }
        
        .search-input { width: 100%; padding: 10px; border: 1.5px solid #ddd; border-radius: 8px; font-size: 0.9rem; margin-bottom: 8px; box-sizing: border-box; }
        .guide-box { background: #fff5f5; border-left: 4px solid var(--red); padding: 12px; border-radius: 8px; height: 100px; overflow-y: auto; margin-bottom: 15px; font-size: 0.9rem; }
        
        /* âœ… ì‹¤ì  í˜„í™©: ë†’ì´ ê³ ì • ë° ìŠ¤í¬ë¡¤ */
        .perf-area { flex-grow: 1; overflow-y: auto; border: 1px solid #eee; border-radius: 8px; max-height: 250px; }
        table { width: 100%; border-collapse: collapse; }
        th { background: #f9fafb; padding: 8px; border-bottom: 2px solid #edf0f2; position: sticky; top: 0; z-index: 5; font-size: 0.8rem; }
        td { padding: 8px; border-bottom: 1px solid #f1f3f5; text-align: center; font-size: 0.85rem; }
        .cum-cell { font-weight: bold; color: var(--blue); }

        /* ëª¨ë°”ì¼ ìµœì í™”: íŒ¨ë„ ë†’ì´ë¥¼ ì¤„ì—¬ì„œ ì „ì²´ í™”ë©´ì— ë“¤ì–´ì˜¤ê²Œ í•¨ */
        @media (max-width: 768px) {
            .main-layout { grid-template-columns: 1fr; }
            .panel { height: auto; min-height: 380px; padding: 12px; }
            .perf-area { max-height: 180px; } /* ëª¨ë°”ì¼ì—ì„œ ì‹¤ì ì°½ ë†’ì´ ì¡°ì ˆ */
        }
    </style>
</head>
<body>

<div class="wrapper">
    <div class="notice-container">
        <div class="notice-header">ğŸ“¢ ê³µì§€ì‚¬í•­</div>
        <div id="notice-list" class="notice-list">ë¡œë”© ì¤‘...</div>
    </div>

    <div class="main-layout">
        <div class="panel">
            <h2>ğŸ“‘ ìƒë‹´ ë©˜íŠ¸</h2>
            <select id="ment-select" class="select-box" onchange="updateMentBox(this.value)">
                <option value="">-- ìƒí™© ì„ íƒ --</option>
            </select>
            <div id="ment-display" class="ment-box"></div>
        </div>

        <div class="panel">
            <h2>ğŸ” ê°€ì´ë“œ & ì‹¤ì </h2>
            <input type="text" id="keyword" class="search-input" placeholder="ë²ˆí˜¸/ë¬¸ì ì…ë ¥..." onkeyup="searchGuide()">
            <div id="guide-display" class="guide-box">ê°€ì´ë“œ ë‚´ìš© í‘œì‹œ</div>

            <div class="perf-area">
                <table>
                    <thead><tr><th>ë‚ ì§œ</th><th>ì™„ë£Œ</th><th>ëˆ„ì </th></tr></thead>
                    <tbody id="perf-list"></tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script>
    // âš ï¸ ê½ƒê²Œë‹˜ì˜ URLì„ ê¼­ ë„£ì–´ì£¼ì„¸ìš”!
    const API_URL = "https://script.google.com/macros/s/AKfycbxTpgRKDGBMrq4IAEozIVSR1gtMdlFwOPosubxZUXG4BaYTYFVgk68lZPjF9dqOzRfEbA/exec";
    let db = { notice: [], ment: [], perf: [] };

    async function loadData() {
        try {
            const res = await fetch(`${API_URL}?t=${Date.now()}`).then(r => r.json());
            db = res;
            document.getElementById('notice-list').innerHTML = db.notice.map(n => `<div class="notice-item"><span class="notice-date">[${n.date}]</span><span>${n.content}</span></div>`).join('');
            const select = document.getElementById('ment-select');
            db.ment.filter(m => m.type).forEach(m => { const opt = document.createElement('option'); opt.value = m.type; opt.innerText = m.type; select.appendChild(opt); });
            let cum = 0;
            document.getElementById('perf-list').innerHTML = db.perf.map(p => {
                const val = parseInt(String(p.val).replace(/[^0-9]/g, '')) || 0;
                cum += val;
                return `<tr><td>${p.date}</td><td>${p.val}</td><td class="cum-cell">${cum.toLocaleString()}</td></tr>`;
            }).join('');
        } catch(e) { document.getElementById('notice-list').innerText = "âŒ ì—°ê²° ì‹¤íŒ¨"; }
    }

    function updateMentBox(v) {
        const box = document.getElementById('ment-display');
        const item = db.ment.find(m => m.type === v);
        if(item) { box.innerText = item.talk; box.style.display = 'block'; }
    }

    function searchGuide() {
        const q = document.getElementById('keyword').value.toLowerCase().trim();
        const display = document.getElementById('guide-display');
        const found = db.ment.find(m => String(m.num).includes(q) || m.key.toLowerCase().includes(q));
        display.innerHTML = found ? `<b>[${found.num}] ${found.key}</b><p style="margin:5px 0;">${found.pos}</p>` : "ê²°ê³¼ ì—†ìŒ";
    }
    window.onload = loadData;
</script>
</body>
</html>
